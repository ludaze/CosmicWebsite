{% extends 'cosmic_base.html' %}

{% block content %}
<div class="form-group pull-left">
  <div style="margin-left: 200px;">
    <strong>
      {% if my_order.order_no%}
      <h2>Order Detail</h2>
      {%else%}
      <h2>Purchase Detail</h2>
      {% endif %}
    </strong>
  </div>

  <br>
  <br>

  <section class="intro">
    <div class="gradient-custom h-100">
      <div class="mask d-flex align-items-center h-100">
        <div class="container">
          <div class="row justify-content-center">
            <div class="col-12">
              <div id="datatable">
                <table class="table table-striped table-bordered" style="margin-left: 30px;">
                  {% if my_order.order_no%}
                  <tr>
                    <th>Order Number</th>
                    <th>Date</th>
                    <th>Total Price</th>
                    <th>Vendor Name</th>
                    <th>Status</th>
                  </tr>

                  <tr>
                    <td><a href="#" class="order-link" data-order-id="{{ my_order.order_no }}">{{ my_order.order_no}}</a></td>
                    <td>{{ my_order.date }}</td>
                    <td>{{ my_order.PR_before_vat }}</td>
                    <td>{{ my_order.customer_name.customer_name }}</td>
                    <td>{{ my_order.status }}</td>
                  </tr>
                  {%else%}
                  <tr>
                    <th>Purchase Number</th>
                    <th>Date</th>
                    <th>Total Price</th>
                    <th>Vendor Name</th>
                    <th>Status</th>
                  </tr>

                  <tr>
                    <td><a href="#" class="order-link" data-order-id="{{ my_order.purchase_no }}">{{my_order.purchase_no }}</a></td>
                    <td>{{ my_order.date }}</td>
                    <td>{{ my_order.before_vat }}</td>
                    <td>{{ my_order.supplier_name.supplier_name }}</td>
                    <td>{{ my_order.status }}</td>
                  </tr>

                  {% endif%}

                </table>
              </div>
              {% if my_order.order_no%}
              <div class="col-md-3">
                <div style="width: 20%;"><button type="submit" class="btn btn-primary"
                    onclick="redirectToPrintOrder('{{ my_order.order_no }}')">Proforma Invoice</button></div>



                <div style="width: 20%;"><button type="submit" class="btn btn-primary"
                    onclick="redirectToCommercialInvoice('{{ my_order.order_no }}')">Commercial Invoice</button></div>



                <div style="width: 20%;"><button type="submit" class="btn btn-primary"
                    onclick="redirectToBillOfLading('{{ my_order.order_no }}')"> Bill of Lading</button></div>
</div>
<div class="col-sm-5">
                <div style="width: 20%;"><button type="submit" class="btn btn-primary"
                    onclick="redirectToTruckWaybill('{{ my_order.order_no }}')"> Truck Waybill</button></div>
                <div style="width: 20%;"><button type="submit" class="btn btn-primary"
                    onclick="redirectToPackingList('{{ my_order.order_no }}')">Packing List</button></div>

                <div style="width: 20%;"><button type="submit" class="btn btn-primary"
                    onclick="redirectToShippingDetails('{{ my_order.order_no }}')">Add Shipping Details</button></div>


              </div>
              {%else%}
              <div class="col-md-6">
                <div style="width: 20%;"><button type="submit" class="btn btn-primary"
                    onclick="redirectToPrintOrder('{{ my_order.purchase_no }}')">Proforma Invoice</button></div>



                <div style="width: 20%;"><button type="submit" class="btn btn-primary"
                    onclick="redirectToCommercialInvoice('{{ my_order.purchase_no }}')">Commercial Invoice</button>
                </div>



                <div style="width: 20%;"><button type="submit" class="btn btn-primary"
                    onclick="redirectToBillOfLading('{{ my_order.purchase_no }}')"> Bill of Lading</button></div>

                <div style="width: 20%;"><button type="submit" class="btn btn-primary"
                    onclick="redirectToTruckWaybill('{{ my_order.purchase_no }}')"> Truck Waybill</button></div>
                <div style="width: 20%;"><button type="submit" class="btn btn-primary"
                    onclick="redirectToPackingList('{{ my_order.purchase_no }}')"> Packing List</button></div>
                <div style="width: 20%;"><button type="submit" class="btn btn-primary"
                    onclick="redirectToShippingDetails('{{ my_order.purchase_no }}')"> Shipping Details</button></div>



              </div>
              {% endif %}
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>



</div>

<script>
  const orderID = document.getElementById('data-order-id');
  function redirectToCommercialInvoice(orderID) {

    window.location.href = `/cosmic/commercial_invoice?order_no=${orderID}`;
  }

  function redirectToBillOfLading(orderID) {
    window.location.href = `/cosmic/bill_of_lading?order_no=${orderID}`;
  }
  function redirectToTruckWaybill(orderID) {

    window.location.href = `/cosmic/truck_waybill?order_no=${orderID}`;
  }

  function redirectToPrintOrder(orderID) {
    window.location.href = `/cosmic/print_order?order_no=${orderID}`;
  }

  function redirectToShippingDetails(orderID) {
    window.location.href = `/cosmic/edit_order?order_no=${orderID}`;
  }
  function redirectToPackingList(orderID) {
    window.location.href = `/cosmic/packing_list?order_no=${orderID}`;
  }
  document.addEventListener('DOMContentLoaded', function () {
    const orderLinks = document.querySelectorAll('.order-link');
    console.log("p1")
    orderLinks.forEach(function (link) {
      link.addEventListener('click', function (event) {
        event.preventDefault();
        console.log("p2")
        const orderID = this.getAttribute('data-order-id');
        window.location.href = `/cosmic/print_order?order_no=${orderID}`;
      });
    });
    const orderLinks2 = document.querySelectorAll('.order-link2');
    console.log("p1")
    orderLinks2.forEach(function (link) {
      link.addEventListener('click', function (event) {
        event.preventDefault();
        console.log("p2")
        const orderID = this.getAttribute('data-order-id');
        window.location.href = `/GRN/print_order?PR_no=${orderID}`;
      });
    });

  });
</script>
{% endblock %}